---
lab:
  title: 연습 11 - Microsoft Sentinel에서 리포지토리 사용
  module: Learning Path 7 - Create detections and perform investigations using Microsoft Sentinel
---

# <a name="learning-path-7---lab-1---exercise-11---use-repositories-in-microsoft-sentinel"></a>학습 경로 7 - 랩 1 - 연습 11 - Microsoft Sentinel에서 리포지토리 사용

## <a name="lab-scenario"></a>랩 시나리오

당신은 Microsoft Sentinel을 구현한 회사에서 근무하는 보안 운영 분석가입니다. 예약됨 및 Microsoft 보안 분석 규칙을 이미 만들었습니다.  Azure DevOps 리포지토리에서 분석 규칙을 중앙 집중화해야 합니다.  그런 다음 Sentinel을 Azure DevOps 리포지토리에 연결하고 콘텐츠를 가져옵니다. 


### <a name="task-1-create-and-export-an-analytical-rule"></a>작업 1: 분석 규칙을 만들고 내보내기

이 작업에서는 Microsoft Sentinel에서 엔터티 동작 분석을 사용하도록 설정합니다.

1. WIN1 가상 머신에 Admin으로 로그인합니다. 암호로는 **Pa55w.rd**를 사용하여 로그인합니다.  

1. 랩 호스팅 공급자가 제공한 **테넌트 전자 메일** 계정을 복사하여 **로그인** 대화 상자에 붙여넣은 후 **다음**을 선택합니다.

1. 랩 호스팅 공급자가 제공한 **테넌트 암호**를 복사하여 **암호 입력** 대화 상자에 붙여넣은 후 **로그인**을 선택합니다.

1. Azure Portal의 검색 창에 *Sentinel*을 입력하고 **Microsoft Sentinel**을 선택합니다.

1. Microsoft Sentinel 작업 영역을 선택합니다.

1. 구성 영역에서 **분석**을 선택합니다.

1. **+ 만들기** 단추를 선택하고 **예약된 쿼리 규칙**을 선택합니다.

1. 분석 규칙 마법사의 일반 탭에서 **Azure DevOps의 규칙** 이름을 입력합니다.

1. 전술의 경우 **지속성**을 선택합니다.

1. 심각도는 **낮음**을 선택합니다.

1. **다음: 규칙 논리 설정 >** 단추를 선택합니다.

1. 규칙 쿼리에 다음 KQL 문을 붙여넣습니다.

    >**경고:** 가상 머신에 붙여넣기 함수를 사용하는 경우 추가(파이프) 문자를 추가할 수 있습니다. 먼저 메모장 사용하여 다음 쿼리를 붙여넣는지 확인합니다.

    ```KQL
    SecurityEvent | where EventID == 4732
    ```

1. **쿼리 결과 보기**를 선택합니다. 결과나 오류를 수신해서는 안 됩니다. 오류가 발생하면 쿼리가 이전 KQL 문과 같이 표시되는지 검토하세요. 오른쪽 위 **X**를 선택하여 로그 창을 닫고 **확인**을 선택하여 취소하고 변경 내용을 저장하여 마법사로 돌아갑니다.


1. 아래로 스크롤하여 쿼리 예약에서 다음을 설정합니다.

    |설정|값|
    |---|---|
    |쿼리 실행 간격|5분|
    |마지막부터 데이터 보기|1일|

    >**참고:** 같은 데이터에 대해 의도적으로 여러 인시던트를 생성합니다. 그러면 랩에서 해당 경고를 사용할 수 있기 때문입니다.

1. 경고 임계값 영역에서 경고가 모든 이벤트를 등록하도록 하므로 값을 변경하지 않고 그대로 둡니다.

1. 쿼리가 위에 지정된 경고 임계값보다 더 많은 결과를 반환하는 한 이벤트 그룹화 영역에서는 실행될 때마다 단일 경고를 생성하려고 하므로 **모든 이벤트를 단일 경고로 그룹화**합니다.

1. 하단에서 **다음: 인시던트 설정 >** 단추를 선택합니다. 

1. 하단에서 **다음: 자동화된 응답 >** 단추를 선택합니다.

1. 하단에서 **다음: 검토 >** 단추를 선택합니다.
 
1. **만들기**를 선택합니다.

1. 방금 만든 규칙을 선택한 다음 도구 모음에서 **내보내기**를 선택합니다.

1. 방금 만든 규칙을 선택한 다음, **삭제**를 선택합니다.


### <a name="task-2-create-our-azure-devops-environment"></a>작업 2: Azure DevOps 환경 만들기

이 작업에서는 Azure DevOps 리포지토리 만들기 및 채우기를 테스트합니다.

1. 브라우저에서 다른 탭을 엽니다.

1. https://aexprodcus1.vsaex.visualstudio.com/me?mkt=en-US로 이동합니다.

1. On the *몇 가지 추가 정보를 입력해 주세요* 페이지에서 **계속**을 선택합니다.

1. Azure DevOps 시작 페이지에서 **새 조직 만들기**를 선택하고 **계속**을 선택합니다.

1. 거의 완료... 페이지에서 나중에 사용하지 않으려는 DevOps 조직의 이름(예: 테넌트 접두사)을 입력합니다. **힌트:** 랩의 리소스 탭(WWLx...)에서 찾을 수 있습니다.

1. 표시되는 문자를 입력한 다음 **계속**합니다.

1. 시작할 프로젝트 만들기 페이지에서 **내 Sentinel 콘텐츠**를 입력한 다음, **프로젝트 만들기**를 선택합니다.

1. 왼쪽 창에서 **리포지토리**로 이동합니다.

1. README 또는 gitignore를 사용하여 기본 분기 초기화 영역의 페이지 아래쪽에서 **초기화**를 선택합니다.

1. 페이지에 리포지토리에 대한 파일이 표시됩니다.  유일한 파일은 README.me입니다.

1. 파일(페이지 오른쪽) 블레이드의 도구 모음에는 *빌드 설정*, *복제* 및 *:* 옵션이 포함됩니다.  **:** 를 선택하여 더 많은 옵션을 표시합니다.

1. **파일 업로드**를 선택합니다.

1. **찾아보기**를 선택하고 다운로드 디렉터리에서 **Azure_Sentinel_analytic_rule.json** 파일을 선택합니다.

1. **커밋**을 선택합니다.

1. 페이지의 왼쪽 위 모서리에서 **Azure DevOps**를 선택합니다.  조직 및 프로젝트가 표시됩니다.

1. 페이지 왼쪽 아래에서 **조직 설정**을 선택합니다.

1. 보안 영역에서 **정책**을 선택합니다.

1. 애플리케이션 연결 정책 영역에서 OAuth를 통해 타사 애플리케이션 액세스를 **설정**합니다. 


### <a name="task-3-connect-sentinel-to-azure-devops"></a>작업 3: Azure DevOps에 Sentinel을 연결합니다.

1. 브라우저에서 *Azure Portal*/*Microsoft Sentinel* 탭을 선택합니다.

1. Microsoft Sentinel의 콘텐츠 관리 섹션에서 **리포지토리(미리 보기)** 를 선택합니다.

1. 도구 모음에서 **새로 추가**를 선택합니다.

1. 이름에 **My Content**를 입력합니다.

1. 소스 제어의 경우 **Azure DevOps**를 선택합니다.

1. **권한 부여**를 선택합니다. 권한 요청을 아래로 스크롤한 다음, **수락**을 선택합니다.

1. 이전에 만든 조직(예: WWLx...)을 선택합니다.

1. 이전에 만든 프로젝트인 내 Sentinel 콘텐츠를 선택합니다.

1. 이전에 만든 리포지토리인 내 Sentinel 콘텐츠를 선택합니다. **힌트:** 리포지토리를 보려면 드롭다운 내에서 아래로 스크롤해야 할 수 있습니다.

1. 분기 **기본**을 선택합니다. **힌트:** 분기를 보려면 드롭다운 내에서 아래로 스크롤해야 할 수 있습니다.

1. 모든 콘텐츠 형식을 선택합니다.

1. 그런 다음 **만들기**를 선택합니다.

1. 필요한 경우 Microsoft Sentinel 작업 영역으로 돌아가기

1. 리포지토리(미리 보기) 페이지로 이동하여 **새로 고침**을 선택합니다. 마지막 배포 상태가 실패한 상태가 될 때까지 기다립니다.   

    >**참고:** 실패한 상태는 호스트된 랩 환경의 제한으로 인해 발생합니다. 일반적으로 성공이 표시됩니다. 그런 다음 Azure DevOps에서 가져온 규칙을 분석에서 확인할 수 있습니다. 


## <a name="you-have-completed-the-lab"></a>이 랩을 완료했습니다.
